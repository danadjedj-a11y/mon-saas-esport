# ğŸš€ Migration Supabase â†’ Convex : COMPLÃˆTE âœ…

Ce document documente la migration de l'application de Supabase vers Convex.

> **Ã‰tat actuel** : âœ… **MIGRATION FRONTEND 100% COMPLÃˆTE !** Tous les fichiers React utilisent maintenant Convex. Build passe en ~6s.

---

## âœ… COMPLÃ‰TÃ‰ - Migration ComplÃ¨te

### RÃ©sumÃ© de la migration :
- âœ… **Tous les fichiers React** migrÃ©s vers Convex
- âœ… **Tous les hooks personnalisÃ©s** migrÃ©s (useActiveMatch, useTournamentBracket, useRealtimeNotifications, useTeam, useMatch)
- âœ… **Tous les utilitaires** migrÃ©s (xpSystem, notifications, matchGenerator)
- âœ… **Tous les services API** remplacÃ©s et supprimÃ©s
- âœ… **Supabase retirÃ© du bundle frontend**

### SchÃ©ma Convex (25 tables) :
- âœ… users, tournaments, tournamentPhases, teams, teamMembers
- âœ… teamInvitations, tournamentRegistrations, matches, matchGames
- âœ… matchVeto, matchChat, notifications, userStats, news, comments
- âœ… swissScores, tournamentFollows, teamFollows, userBadges, userLevels
- âœ… tournamentRatings, games, playerGameAccounts, bracketSlots
- âœ… gamingAccountChangeRequests

### Fichiers Core migrÃ©s :
- âœ… Tournament.jsx, TeamJoinButton.jsx, CheckInButton.jsx
- âœ… SeedingModal.jsx, SchedulingModal.jsx, AdminPanel.jsx
- âœ… Dashboard.jsx, PublicTournament.jsx, NotificationCenter.jsx
- âœ… Chat.jsx, MatchLobby.jsx, MatchDetails.jsx
- âœ… MapVetoSystem.jsx (migrÃ© vers `convex/matchVeto.ts`)

### Toutes les pages migrÃ©es :
- âœ… Pages Play (PlayHome, SearchResults, GamesDirectory, GamePage)
- âœ… Pages Embed (6 pages)
- âœ… Pages Tournament (TournamentRegister)
- âœ… Pages Organizer (25+ pages)
- âœ… Pages Profile (PrivacySettings, PublicProfile, PublicTeam)
- âœ… Pages Stream (StreamOverlay, StreamDashboard)
- âœ… Pages Admin (AdminUsers) - **NOUVEAU**

### Page d'administration des utilisateurs :
- âœ… Route : `/organizer/admin/users`
- âœ… Permet de changer les rÃ´les : player â†” organizer
- âœ… Query : `api.users.listAll` avec filtre par rÃ´le
- âœ… Mutation : `api.usersMutations.updateRole`

### Fichiers supprimÃ©s (nettoyage) :
- âœ… src/supabaseClient.js
- âœ… src/App.backup.jsx
- âœ… src/components/registration/TournamentRegistration_backup.jsx
- âœ… src/shared/services/api/ (dossier entier)

---

## ğŸ Ã‰tat Actuel

âœ… **Build rÃ©ussi** : `npm run build` passe en ~6s
âœ… **Dev server** : `npm run dev` fonctionne
âœ… **Migration frontend** : 100% complÃ¨te
âœ… **Supabase** : RetirÃ© du bundle frontend
âœ… **SchÃ©ma Convex** : 25 tables vÃ©rifiÃ©es, pas de doublons

### Fichiers backend encore avec Supabase :
Ces fichiers sont des API routes serveur (Vercel), pas du code frontend :
- ğŸ”² server/api.js
- ğŸ”² api/tournament.js
- ğŸ”² api/tournament/[id]/[endpoint].js

### Comment changer un compte player â†’ organizer :
1. AccÃ©der Ã  `/organizer/admin/users` (rÃ©servÃ© aux organisateurs)
2. Trouver l'utilisateur dans la liste
3. Cliquer "Promouvoir" pour le passer en organizer

**Via code** :
```javascript
const updateRole = useMutation(api.usersMutations.updateRole);
await updateRole({ userId: user._id, role: "organizer" });
```

### Prochaines Ã©tapes optionnelles :
1. ğŸ”² Migrer les API routes Vercel vers Convex HTTP actions
2. ğŸ”² DÃ©sinstaller complÃ¨tement `@supabase/supabase-js` aprÃ¨s migration backend
